#!/bin/sh

# $TSUKUBA_Release: Omni OpenMP Compiler 3 $
# $TSUKUBA_Copyright:
#  PLEASE DESCRIBE LICENSE AGREEMENT HERE
#  $

BINDIR=`dirname $0`
args=''
prev_args=''
for i in "$@"; do
    case ${prev_args} in
        -M)
          args="${args} -M${i} -m{i}"
          prev_args="";;
        *)
    case "${i}" in
#       -fopenmp)
#           args="${args} --Wf-fopenmp"
#               for j in "-fopenmp -lgomp"; do
#                       args="${args} --Wn${j}"
#               done;;
        -J?*)
           foo=`echo ${i}|sed "s/-J\(.*\)/-M\1/"`
           bar=`echo ${i}|sed "s/-J\(.*\)/-m\1/"`
           args="${args} ${foo} ${bar}";;
        -J)
           prev_args="-M";;
        -tmp)
            args="${args} --Wn${i}";;
        *)
            args="${args} ${i}"
            prev_args="";;
    esac
  esac
done

set -- ${args}

${BINDIR}/omdriver --xf -Txmpf "$@"

exit $?

